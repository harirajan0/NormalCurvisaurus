---
title: "Datathon Slide Template"
author: "Rebecca C. Steorts"
date: September 27 2018
output: 
     beamer_presentation:
      includes: 
          in_header: slide-template/custom2.tex
          

font-size: 12px
---
```{r, echo=FALSE}
#Load necessary packages
library("magrittr")
library("tidyr")
library("ggplot2")
```

```{r, echo=FALSE}
#Reading in the data
user_data = read.csv('data/user_profile.csv')
summary(user_data)

#Removing columns that are redundant and cover the same information
data.pre = user_data[-c(1, 3, 4, 5, 27, 28, 36)]

#ishomeowner, gender(remove unisex), remove NA from 8, 9, 10, 27, 28
data.pre = subset(data.pre, (data.pre$gender == 'Male' | data.pre$gender == 'Female'))
data.pre= na.omit(data.pre)
data.pre$gender = data.pre$gender == 'Female'
data.pre$is_homeowner = data.pre$is_homeowner == 'True'
cols <- sapply(data.pre, is.logical)
data.pre[,cols] <- lapply(data.pre[,cols], as.numeric)

#turning the buckets into continous values - we average the bucket's min & max to the middle value

#cor(data.pre[-1])

decode_bucket <- function(fctr) {
  fctr <- gsub("[()]", '', fctr)
  fctr <- gsub("\\]", '', fctr)
  bounds <- strsplit(fctr, ", ")
  return(mean(as.numeric(bounds[[1]])))
}
data.pre$age = unlist(lapply(data.pre$age_bucket, FUN = decode_bucket))
data.pre$credit_score = unlist(lapply(data.pre$credit_score_bucket, FUN = decode_bucket))
data.pre = na.omit(data.pre)

#removing bucketed columns
data.pre = data.pre[-c(31,32)]
```

Data set
===

- The data was from Credit Sesame, a company that calculates credit scores to determine options for credit cards, mortgage rates and loans. This dataset included: 
      -User Demographics - credit profile information including loan histories, tradeline details, etc, and a few personal features such as gender and location
      -First Session Information - action logs of each user's first interaction with the Credit Sesame website
      -30-day User Engagement Data - insight into the actions of users in each one's first 30 days which included various logins for each user

Dislay of Data Through Initial Exploration
===
```{r}
#Plot histogram of each column in user_data
data.pre %>% gather() %>% head()
ggplot(gather(data.pre[seq(2,15)]), aes(value)) + 
    geom_histogram(bins=10) + 
    facet_wrap(~key, scales = 'free_x')
ggplot(gather(data.pre[seq(16,31)]), aes(value)) + 
    geom_histogram(bins=10) + 
    facet_wrap(~key, scales = 'free_x')
``` 

Exploring the Dataset 
===
- Started EDA by looking at the distribution of each of the variables in the dataset, as shown in the previous slide.
- Almost all the non-categorical data was heavily skewed to the right.
- Many variables had high frequency for lower values and significantly lower frequency for higher values
- Only non-cateogrical variables not heavily skewed were `age` and `credit_score`. 

This was important to keep in mind as we proceeded in our analysis as the distribution of each variable can impact the results of our analysis methods.


Challenges of the Dataset
===

- The skewed distribution of our variables was the biggest challenge for determining how to analyze this data.
- Ultimately we did not let the skew effect our methods but were careful to consider it in our analysis.

Methods
===

- We used several methods: PCA, Regression Analysis, and k-means clusterng
- Our most successful method was the k-means clustering
- To evalute this method, we compared how the data differed between the clusters

Results
===

- We noticed that in particular, there were two clusters which had relatively high values for `click_count_credit_card` and `click_count_personal_loan`, respectively
- ADD VISUAL HERE SHOWING THE CLUSTERS

Results (continued)
===

- The users that were grouped into these two clusters had a noticeably large difference in the mean values for several different variables as shown below. Note that these variable values generally correspond to the user's frewuent actions on the Credit Sesame website.
- ADD VISUAL HERE SHOWING THE DIFFERENCE IN THE MEANS

Conclusions
===

- Our PCA and Linear Regression Analysis both support the conclusion that longer opened accounts and higher credit card limits are two of the strongest indicators of credit scores. Additionally, homeowner status and number of accounts turned over to collection agencies as strong predictors of credit score.
- Our k-means clustering concluded that Credit Sesame's website clientele that use the credit card links are different from the people who used the website for loans.
- Future Work: Moving fowards, we can work to improve the current models that we used. For example, our regression model could've been improved using other regression methods such as Lasso or ElasticNet so we wouldn't have to do feature selection by hand. Additionally, we could've tried clustering by usuing hierarchical clustering to see if we could get more informative results. 